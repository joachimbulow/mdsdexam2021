grammar org.xtext.example.mydsl.ExTwentyOne with org.eclipse.xtext.common.Terminals

generate exTwentyOne "http://www.xtext.org/example/mydsl/ExTwentyOne"

Program: 'program' name=ID (declarations+=Declaration)*
;

Declaration: 
	Function | Input | Node | Stream | DataDecl | Parameter
;

Parameter: 
	'parameter' name=ID ':' Type
;

Function: 
	'function' name=ID lambda=Lambda	
;

Lambda:
	'(' name=ID ':' Type ')' '{' Exp '}'
;

Input:
	'input' name=ID ':' Type
;

Node:
	'node' name=ID '[' lambda = [Lambda] | Lambda ']'
;

Stream:
	'stream' inputs+=[Input] (',' inputs+=[Input])* ('to' elements+=[Element] (',' elements+=[Element])* )+
;

Element: 
	element=ID | '[' (Node | Lambda) ']' | 'output' output=ID
;

DataDecl:
	'data' name=ID '{' data+=ID ':' Type (',' data+=ID ':' Type)* '}'
;


Type: 
	'int' | 'string' | ID
;

Exp: Exp '+' Exp | Exp '-' Exp | Exp '*' Exp | Exp '/' Exp
| INT | '(' Exp ')' | 'let' ID '=' Exp 'in' Exp 'end'
| ID ( '.' ID )* | 'none' | 'if' LogicExp 'then' Exp 'else' Exp 'end'
| 'new' ID '[' ID '=' Exp (',' ID '=' Exp)* ']'
;

LogicExp: 
	Exp ('=' | '<' | '>' | '<=' | '>=') Exp
;